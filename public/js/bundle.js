function preloadImages(arguments){for(var e=0;e<arguments.length;e++){var n=document.createElement("img");n.src=arguments[e],imagesPreloaded.push(n)}}var images=["public/img/gerb/bottom-bar-hover.png","public/img/gerb/castle.gif","public/img/gerb/sun.gif","public/img/gerb/key.gif","public/img/gerb/bird.gif","public/img/nav/history-hover.png","public/img/nav/niva-hover.png","public/img/nav/roman-past-hover.png","public/img/nav/theaters-hover.png","public/img/scrolltop-hover.jpg"],imagesPreloaded=[];preloadImages(images);var htmlElement=null,scrollTopComponent=null;$(function(){htmlElement=$("html, body"),scrollTopComponent=$("#scroll-to-top"),gerbComponents.gerb=$("#gerb"),gerbComponents.castle=gerbComponents.gerb.find(".castle"),gerbComponents.sun=gerbComponents.gerb.find(".sun"),gerbComponents.key=gerbComponents.gerb.find(".key"),gerbComponents.bird=gerbComponents.gerb.find(".bird"),navComponents.mainNav=$("#main-nav"),navComponents.contentWrap=$(".content-wrap"),navComponents.content=navComponents.contentWrap.find(".content"),navComponents.headingImg=navComponents.contentWrap.find(".title-img"),navComponents.pageSlide=$("#page-slide"),gerbController.init(),navController.init(),$(window).scroll(function(){window.pageYOffset>370?scrollTopComponent.fadeIn("slow"):scrollTopComponent.fadeOut("slow")}),scrollTopComponent.on("click",function(){htmlElement.animate({scrollTop:0},1e3)})});var navComponents={mainNav:null,contentWrap:null,content:null,headingImg:null,pageSlide:null},navController=function(e,n){function t(t){p.animating=!0,htmlElement.animate({scrollTop:e.mainNav.offset().top},1e3),e.content.html(t),e.contentWrap.slideDown(n,function(){p.animating=!1})}function o(t){p.animating=!0,e.contentWrap.slideUp(n,t)}function i(e,n){if(p.pages.hasOwnProperty(e))return void n(p.pages[e]);$.ajax({url:location.href+"partials/"+e+".html",method:"GET"}).done(function(t){p.pages[e]=t,n(t)})}function r(n,o){p.activeBtn=n.addClass("active"),e.headingImg.addClass(o),i(o,t)}function a(){o(function(){p.activeBtn.removeClass("active");var n=p.activeBtn.data("content");e.headingImg.removeClass(n),p.activeBtn=null,p.animating=!1})}function l(n,t){o(function(){var o=p.activeBtn.data("content");e.headingImg.removeClass(o),p.activeBtn.removeClass("active"),r(n,t)})}function s(){e.mainNav.on("click",".nav-item",function(){if(!p.animating){var e=$(this),n=e.data("content"),t=e.hasClass("active");if(null===p.activeBtn)return void r(e,n);t?a():l(e,n)}}),e.pageSlide.on("click",function(e){p.animating||a()})}var p={animating:!1,activeBtn:null,pages:{}};return{init:s,state:p}}(navComponents,2e3),gerbComponents={gerb:null,castle:null,sun:null,key:null,bird:null},gerbController=function(e,n){function t(){a.castle=new Castle(e.castle,n),a.sun=new Sun(e.sun,n),a.key=new Key(e.key,n),a.bird=new Bird(e.bird,n)}function o(){l.animating=!1,l.opened.changeIcon(!1),l.opened=null}function i(n){l.opened=n,l.opened.changeIcon(!0),l.opened.open(e).then(function(){l.animating=!1})}function r(){t(),e.gerb.on("click",".icon",function(){if(!0!==l.animating){var n=$(this).parent(".gerb-item").data("name");l.animating=!0;l.opened?l.opened.close(e).then(function(){l.opened.changeIcon(!1),l.opened.getName()===n?o():i(a[n])}):i(a[n])}}).on("click",".bottom-bar",function(){l.opened.close(e).then(function(){o()})})}var a={},l={opened:null,animating:!1};return{init:r}}(gerbComponents,1e3),Wings={open:function(e){var n=gerbComponents.key.animate({left:-98},e).promise(),t=gerbComponents.bird.animate({right:-100},e).promise();return Promise.all([n,t])},close:function(e){var n=gerbComponents.key.animate({left:7},e).promise(),t=gerbComponents.bird.animate({right:5},e).promise();return Promise.all([n,t])}},GerbItem=function(e,n,t){this.element=e,this.name=n,this.delay=t};GerbItem.prototype.open=function(){},GerbItem.prototype.close=function(){},GerbItem.prototype.getName=function(){return this.name},GerbItem.prototype.textSlideDown=function(e){return this.element.find(".text").slideDown(e).promise()},GerbItem.prototype.textSlideUp=function(e){return this.element.find(".text").slideUp(e).promise()},GerbItem.prototype.changeIcon=function(e){var n=this.name+(e?".gif":".png");this.element.find(".icon").css("background-image","url(public/img/gerb/"+n+")")};var Castle=function(e,n){GerbItem.apply(this,[e,"castle",n])};Castle.prototype=Object.create(GerbItem.prototype),Castle.prototype.open=function(e){var n=this,t=this.delay;return Wings.open(t).then(function(){return e.sun.animate({top:100},t).promise()}).then(function(){var o=e.sun.animate({top:230},t).promise(),i=n.textSlideDown(t);return Promise.all([o,i])})},Castle.prototype.close=function(e){var n=this.delay,t=this.textSlideUp(n),o=e.sun.animate({top:100},n).promise();return Promise.all([t,o]).then(function(){return e.sun.animate({top:62},n).promise()}).then(function(){return Wings.close(n)})};var Sun=function(e,n){GerbItem.apply(this,[e,"sun",n])};Sun.prototype=Object.create(GerbItem.prototype),Sun.prototype.open=function(){var e=this;e.element.find(".scroll").show();var n=this.delay;return Wings.open(n).then(function(){return e.textSlideDown(n)})},Sun.prototype.close=function(){var e=this.element.find(".scroll"),n=this.delay;return this.textSlideUp(n).then(function(){return Wings.close(n)}).then(function(){return e.hide().promise()})};var Key=function(e,n){GerbItem.apply(this,[e,"key",n])};Key.prototype=Object.create(GerbItem.prototype),Key.prototype.open=function(e){var n=this,t=this.element.find(".bar"),o=this.delay,i=t.animate({width:180},o).promise(),r=e.bird.animate({right:-190},o).promise(),a=Promise.all([i,r]).then(function(){return n.textSlideDown(o)});return $(window).outerWidth()<390?a.then(function(){return n.element.animate({left:-30},o).promise()}):a},Key.prototype.close=function(e){var n=this,t=this.delay;return $(window).outerWidth()<390?n.element.animate({left:7},t).promise().then(function(){return n.closePromise(e)}):n.closePromise(e)},Key.prototype.closePromise=function(e){var n=this.element.find(".bar"),t=this.delay;return this.textSlideUp(t).then(function(){var o=n.animate({width:0},t).promise(),i=e.bird.animate({right:5},t).promise();return Promise.all([o,i])})};var Bird=function(e,n){GerbItem.apply(this,[e,"bird",n])};Bird.prototype=Object.create(GerbItem.prototype),Bird.prototype.open=function(e){var n=this,t=this.element.find(".bar"),o=this.delay,i=t.animate({width:180},o+80).promise(),r=e.key.animate({left:-188},o).promise(),a=Promise.all([i,r]).then(function(){return n.textSlideDown(o)});return $(window).outerWidth()<390?a.then(function(){return n.element.animate({right:-30},o).promise()}):a},Bird.prototype.close=function(e){var n=this,t=this.delay;return $(window).outerWidth()<390?n.element.animate({right:5},t).promise().then(function(){return n.closePromise(e)}):n.closePromise(e)},Bird.prototype.closePromise=function(e){var n=this.element.find(".bar"),t=this.delay;return this.textSlideUp(t).then(function(){var o=n.animate({width:0},t).promise(),i=e.key.animate({left:7},t+80).promise();return Promise.all([o,i])})};